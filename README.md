
# **Heap Package Docs**

## **Package Description**

> The purpose of this DBT project is to help folks with getting started with Heap data synced to a data warehouse via Heap Connect. 
> This project comes with the following baked in: 
> 1. A heap_sources.yml file which includes documentation, freshness checks, and basic tests for the built-in views that ship with Heap Connect
> 2. Logic to handle incremental table transformations of the source data synced to your warehouse via Heap Connect
> 3. Macros which can be used to quickly spin up attribution and funnel analysis 
> 4. An opinionated viewpoint on how to best structure DBT projects in terms of folder structure and naming conventions in order to promote adoption and collaboration

## **Materialized Table Schemas**

### **stg_heap_events_all_inc_fct** 

| Column Name     | Description                                        | Source        |
|-----------------|----------------------------------------------------|---------------|
| heap_user_id    | Unique ID generated by Heap and stored as a cookie | Heap Built In |
| heap_session_id | Unique ID generated by Heap and stored as a cookie | Heap Built In |

### **stg_heap_pageview_sessions_inc_fct**

| Column Name     | Description                                        | Source        |
|-----------------|----------------------------------------------------|---------------|
| heap_user_id    | Unique ID generated by Heap and stored as a cookie | Heap Built In |
| heap_session_id | Unique ID generated by Heap and stored as a cookie | Heap Built In |
### **stg_heap_sessions_inc_fct**

| Column Name     | Description                                        | Source        |
|-----------------|----------------------------------------------------|---------------|
| heap_user_id    | Unique ID generated by Heap and stored as a cookie | Heap Built In |
| heap_session_id | Unique ID generated by Heap and stored as a cookie | Heap Built In |
## **Incremental Logic** 

### **Warehouse Specific Configs**

#### **Snowflake** 

- [Snowflake Configurations](https://docs.getdbt.com/reference/resource-configs/snowflake-configs)
- [Snowflake Incremental Config](https://docs.getdbt.com/reference/resource-configs/snowflake-configs#merge-behavior-incremental-models)

```
{{
  config(
    unique_key='replace_me_w_unique_id'
  )
}}
```

#### **Big Query** 

- [BigQuery Configurations](https://docs.getdbt.com/reference/resource-configs/bigquery-configs)
- [BigQuery Incremental Config](https://docs.getdbt.com/reference/resource-configs/bigquery-configs#merge-behavior-incremental-models)

```
{{ config(
  partition_by={
      "field":"heap_pageview_time",
      "data_type":"timestamp",
      "granularity":"day"
    },
    cluster_by = ['replace_me_w_unique_id'],
    unique_key = 'replace_me_w_unique_id'
  )
}}
```

#### **Redshift** 

- [Redshift Configurations](https://docs.getdbt.com/reference/resource-configs/redshift-configs)
- [Redshift Optimization](https://docs.getdbt.com/reference/resource-configs/redshift-configs#performance-optimizations)

```
{{
  config(
    sort = 'heap_event_time',
    dist = 'heap_event_id',
    unique_key = 'replace_me_w_unique_id'
  )
}}
```

## **Funnel Analysis** 

## **Attribution**
